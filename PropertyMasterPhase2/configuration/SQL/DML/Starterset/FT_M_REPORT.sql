insert into ft_m_report (seq_no,name,last_upd_tms,to_mail,info_mail,mail_sub,blank_mail_body,green_col,amber_col,red_col,query,upd_query,alert_type,alert_lang,rev,action_to_take,result,count) select 1 as seq_no, 'LatLongMismatch' as name, SYSDATE() as last_upd_tms, 'ITOPSDataQuality@Nuveen.com' as to_mail, 'ITOPSDataQuality@Nuveen.com' as info_mail, 'NRE:Building Master - Latitude/Longitude Mismatch' as mail_sub, 'No Data Found for this Run' as blank_mail_body, 'MAIN_STATUS:OK' as green_col, 'MAIN_STATUS:WARNING' as amber_col, 'MAIN_STATUS:KO' as red_col, 'select abc.prop_id as BuildingID, abc.property_nme as BuildingName, abc.verf_lat as APIVerified_Latitude,abc.mail_lat as Mailing_Latitude, abc.verf_long as APIVerified_Longitude, abc.mail_long as Mailing_Longitude from ( select ftp.prop_id,ppry.property_nme , ccrf.ppry_oid, adp.cntl_cross_ref_oid,adp.addr_typ , adp.mail_addr_id, dept_nme as verf_lat ,sub_dept_nme as verf_long,lag(dept_nme) over (partition by adp.cntl_cross_ref_oid order by  adp.addr_typ) as mail_lat,   lag(sub_dept_nme) over (partition by adp.cntl_cross_ref_oid order by  adp.addr_typ) as mail_long,to_number(dept_nme,''999D999'') - lag(to_number(dept_nme,''999D999'')) over (partition by adp.cntl_cross_ref_oid order by  adp.addr_typ) as diff_lat,to_number(dept_nme,''999D999'') - lag(to_number(dept_nme,''999D999'')) over (partition by adp.cntl_cross_ref_oid order by  adp.addr_typ) as diff_long from ft_t_madr madr,ft_t_adtp adp, ft_T_ccrf ccrf,ft_t_ppid ftp, ft_t_ppry ppry where 1=1 and adp.mail_addr_id = madr.mail_addr_id and ccrf.cntl_cross_ref_oid = adp.cntl_cross_ref_oid and ftp.ppry_oid = ccrf.ppry_oid and ccrf.ppry_oid = ppry.ppry_oid and ftp.prop_id_ctxt_typ = ''ASSETNO'' and ppry.end_tms is null ) abc where abc.addr_typ = ''VERFMAPS'' and (abc.diff_lat <> 0 or abc.diff_long <> 0)' as query, NULL as upd_query, 'Report' as alert_type, 'Sql' as alert_lang, 'N' as rev, NULL as action_to_take, NULL as result, '0' as count on conflict(seq_no) where (seq_no=1 and name='LatLongMismatch') do update set seq_no=excluded.seq_no, name=excluded.name, last_upd_tms=excluded.last_upd_tms, to_mail=excluded.to_mail, info_mail=excluded.info_mail, mail_sub=excluded.mail_sub, blank_mail_body=excluded.blank_mail_body, green_col=excluded.green_col, amber_col=excluded.amber_col, red_col=excluded.red_col, query=excluded.query, upd_query=excluded.upd_query, alert_type=excluded.alert_type, alert_lang=excluded.alert_lang, rev=excluded.rev, action_to_take=excluded.action_to_take, result=excluded.result, count=excluded.count;
insert into ft_m_report (seq_no,name,last_upd_tms,to_mail,info_mail,mail_sub,blank_mail_body,green_col,amber_col,red_col,query,upd_query,alert_type,alert_lang,rev,action_to_take,result,count) select 2 as seq_no, 'NewBuildIDYardiY' as name, SYSDATE() as last_upd_tms, 'lauren.stokes@nuveen.com' as to_mail, 'lauren.stokes@nuveen.com' as info_mail, 'NRE:Building Master - New Buildings in GS' as mail_sub, 'No Data Found for this Run' as blank_mail_body, 'MAIN_STATUS:OK' as green_col, 'MAIN_STATUS:WARNING' as amber_col, 'MAIN_STATUS:KO' as red_col, 'select ppid.prop_id as buildingid, ppry.property_nme as buildingname, ppid.last_chg_usr_id as update_userid, ppid.last_chg_tms as update_time from ft_T_ppry ppry, ft_T_ppid ppid where 1=1 and ppry.ppry_oid = ppid.ppry_oid  and ppid.prop_id_ctxt_typ = ''ASSETNO'' and ppry.end_tms is null and ppid.end_tms is null and ppry.real_estate_owned_ind = ''Y'' and ppry.ppty_oid in (select ppty.ppty_oid from ft_T_ppty ppty where ppty.prop_typ = ''Building'') and ppid.start_tms > now()  - INTERVAL ''1'' DAY' as query, NULL as upd_query, 'Report' as alert_type, 'Sql' as alert_lang, 'N' as rev, NULL as action_to_take, NULL as result, '0' as count on conflict(seq_no) where (seq_no=2 and name='NewBuildIDYardiY') do update set seq_no=excluded.seq_no, name=excluded.name, last_upd_tms=excluded.last_upd_tms, to_mail=excluded.to_mail, info_mail=excluded.info_mail, mail_sub=excluded.mail_sub, blank_mail_body=excluded.blank_mail_body, green_col=excluded.green_col, amber_col=excluded.amber_col, red_col=excluded.red_col, query=excluded.query, upd_query=excluded.upd_query, alert_type=excluded.alert_type, alert_lang=excluded.alert_lang, rev=excluded.rev, action_to_take=excluded.action_to_take, result=excluded.result, count=excluded.count;
insert into ft_m_report (seq_no,name,last_upd_tms,to_mail,info_mail,mail_sub,blank_mail_body,green_col,amber_col,red_col,query,upd_query,alert_type,alert_lang,rev,action_to_take,result,count) select 3 as seq_no, 'NewBuildIDYardiN' as name, SYSDATE() as last_upd_tms, 'carmen.workman@nuveen.com' as to_mail, 'carmen.workman@nuveen.com' as info_mail, 'NRE:Building Master - New Buildings in GS' as mail_sub, 'No Data Found for this Run' as blank_mail_body, 'MAIN_STATUS:OK' as green_col, 'MAIN_STATUS:WARNING' as amber_col, 'MAIN_STATUS:KO' as red_col, 'select ppid.prop_id as buildingid, ppry.property_nme as buildingname, ppid.last_chg_usr_id as update_userid, ppid.last_chg_tms as update_time from ft_T_ppry ppry, ft_T_ppid ppid where 1=1 and ppry.ppry_oid = ppid.ppry_oid  and ppid.prop_id_ctxt_typ = ''ASSETNO'' and ppry.end_tms is null and ppid.end_tms is null and ppry.real_estate_owned_ind = ''N'' and ppry.ppty_oid in (select ppty.ppty_oid from ft_T_ppty ppty where ppty.prop_typ = ''Building'') and ppid.start_tms > now()  - INTERVAL ''1'' DAY' as query, NULL as upd_query, 'Report' as alert_type, 'Sql' as alert_lang, 'N' as rev, NULL as action_to_take, NULL as result, '0' as count on conflict(seq_no) where (seq_no=3 and name='NewBuildIDYardiN') do update set seq_no=excluded.seq_no, name=excluded.name, last_upd_tms=excluded.last_upd_tms, to_mail=excluded.to_mail, info_mail=excluded.info_mail, mail_sub=excluded.mail_sub, blank_mail_body=excluded.blank_mail_body, green_col=excluded.green_col, amber_col=excluded.amber_col, red_col=excluded.red_col, query=excluded.query, upd_query=excluded.upd_query, alert_type=excluded.alert_type, alert_lang=excluded.alert_lang, rev=excluded.rev, action_to_take=excluded.action_to_take, result=excluded.result, count=excluded.count;
insert into ft_m_report (seq_no,name,last_upd_tms,to_mail,info_mail,mail_sub,blank_mail_body,green_col,amber_col,red_col,query,upd_query,alert_type,alert_lang,rev,action_to_take,result,count) select 4 as seq_no, 'COCompDateYardiY' as name, SYSDATE() as last_upd_tms, 'lauren.stokes@nuveen.com' as to_mail, 'lauren.stokes@nuveen.com' as info_mail, 'NRE:Building Master - CO Completion Date Alert' as mail_sub, 'No Data Found for this Run' as blank_mail_body, 'MAIN_STATUS:OK' as green_col, 'MAIN_STATUS:WARNING' as amber_col, 'MAIN_STATUS:KO' as red_col, 'select ppid.prop_id as buildingid, ppry.property_nme as buildingname, to_char(ppst.stat_val_dte,''DD-MM-YYYY'') as CertOfcompletionDate, ppid.last_chg_usr_id as update_userid, ppid.last_chg_tms as update_time from ft_T_ppry ppry, ft_T_ppid ppid, ft_T_ppst ppst where 1=1 and ppry.ppry_oid = ppid.ppry_oid and ppry.ppry_oid = ppst.ppry_oid  and ppid.prop_id_ctxt_typ = ''ASSETNO'' and ppst.stat_def_id = ''NREOCDTE'' and ppry.end_tms is null and ppid.end_tms is null and ppst.end_tms is null and ppry.real_estate_owned_ind = ''Y'' and ppry.ppty_oid in (select ppty.ppty_oid from ft_T_ppty ppty where ppty.prop_typ = ''Building'') and (ppst.stat_val_dte > now() and  ppst.stat_val_dte < now()  + INTERVAL ''30'' day)' as query, NULL as upd_query, 'Report' as alert_type, 'Sql' as alert_lang, 'N' as rev, NULL as action_to_take, NULL as result, '0' as count on conflict(seq_no) where (seq_no=4 and name='COCompDateYardiY') do update set seq_no=excluded.seq_no, name=excluded.name, last_upd_tms=excluded.last_upd_tms, to_mail=excluded.to_mail, info_mail=excluded.info_mail, mail_sub=excluded.mail_sub, blank_mail_body=excluded.blank_mail_body, green_col=excluded.green_col, amber_col=excluded.amber_col, red_col=excluded.red_col, query=excluded.query, upd_query=excluded.upd_query, alert_type=excluded.alert_type, alert_lang=excluded.alert_lang, rev=excluded.rev, action_to_take=excluded.action_to_take, result=excluded.result, count=excluded.count;
insert into ft_m_report (seq_no,name,last_upd_tms,to_mail,info_mail,mail_sub,blank_mail_body,green_col,amber_col,red_col,query,upd_query,alert_type,alert_lang,rev,action_to_take,result,count) select 5 as seq_no, 'COCompDateYardiN' as name, SYSDATE() as last_upd_tms, 'carmen.workman@nuveen.com' as to_mail, 'carmen.workman@nuveen.com' as info_mail, 'NRE:Building Master - CO Completion Date Alert' as mail_sub, 'No Data Found for this Run' as blank_mail_body, 'MAIN_STATUS:OK' as green_col, 'MAIN_STATUS:WARNING' as amber_col, 'MAIN_STATUS:KO' as red_col, 'select ppid.prop_id as buildingid, ppry.property_nme as buildingname, to_char(ppst.stat_val_dte, ''DD-MM-YYYY'') as CertOfcompletionDate, ppid.last_chg_usr_id as update_userid, ppid.last_chg_tms as update_time from ft_T_ppry ppry, ft_T_ppid ppid, ft_T_ppst ppst where 1=1 and ppry.ppry_oid = ppid.ppry_oid and ppry.ppry_oid = ppst.ppry_oid and ppid.prop_id_ctxt_typ = ''ASSETNO'' and ppst.stat_def_id = ''NREOCDTE'' and ppry.end_tms is null and ppid.end_tms is null and ppst.end_tms is null and ppry.real_estate_owned_ind = ''N'' and ppry.ppty_oid in (select ppty.ppty_oid from ft_T_ppty ppty where ppty.prop_typ = ''Building'') and (ppst.stat_val_dte > now() and ppst.stat_val_dte < now() + INTERVAL ''30'' day)' as query, NULL as upd_query, 'Report' as alert_type, 'Sql' as alert_lang, 'N' as rev, NULL as action_to_take, NULL as result, '0' as count on conflict(seq_no) where (seq_no=5 and name='COCompDateYardiN') do update set seq_no=excluded.seq_no, name=excluded.name, last_upd_tms=excluded.last_upd_tms, to_mail=excluded.to_mail, info_mail=excluded.info_mail, mail_sub=excluded.mail_sub, blank_mail_body=excluded.blank_mail_body, green_col=excluded.green_col, amber_col=excluded.amber_col, red_col=excluded.red_col, query=excluded.query, upd_query=excluded.upd_query, alert_type=excluded.alert_type, alert_lang=excluded.alert_lang, rev=excluded.rev, action_to_take=excluded.action_to_take, result=excluded.result, count=excluded.count;
insert into ft_m_report (seq_no,name,last_upd_tms,to_mail,info_mail,mail_sub,blank_mail_body,green_col,amber_col,red_col,query,upd_query,alert_type,alert_lang,rev,action_to_take,result,count) select 6 as seq_no, 'EndBuildIDYardiY' as name, SYSDATE() as last_upd_tms, 'lauren.stokes@nuveen.com' as to_mail, 'lauren.stokes@nuveen.com' as info_mail, 'NRE:Building Master - Removed Buildings in GS' as mail_sub, 'No Data Found for this Run' as blank_mail_body, 'MAIN_STATUS:OK' as green_col, 'MAIN_STATUS:WARNING' as amber_col, 'MAIN_STATUS:KO' as red_col, 'select ppid.prop_id as buildingid, ppry.property_nme as buildingname, ppid.last_chg_usr_id as update_userid, ppid.last_chg_tms as update_time from ft_T_ppry ppry, ft_T_ppid ppid where 1=1 and ppry.ppry_oid = ppid.ppry_oid  and ppid.prop_id_ctxt_typ = ''ASSETNO'' and ppry.end_tms is not null and ppry.real_estate_owned_ind = ''Y'' and ppry.ppty_oid in (select ppty.ppty_oid from ft_T_ppty ppty where ppty.prop_typ = ''Building'') and ppid.end_tms > now()  - INTERVAL ''1'' DAY' as query, NULL as upd_query, 'Report' as alert_type, 'Sql' as alert_lang, 'N' as rev, NULL as action_to_take, NULL as result, '0' as count on conflict(seq_no) where (seq_no=6 and name='EndBuildIDYardiY') do update set seq_no=excluded.seq_no, name=excluded.name, last_upd_tms=excluded.last_upd_tms, to_mail=excluded.to_mail, info_mail=excluded.info_mail, mail_sub=excluded.mail_sub, blank_mail_body=excluded.blank_mail_body, green_col=excluded.green_col, amber_col=excluded.amber_col, red_col=excluded.red_col, query=excluded.query, upd_query=excluded.upd_query, alert_type=excluded.alert_type, alert_lang=excluded.alert_lang, rev=excluded.rev, action_to_take=excluded.action_to_take, result=excluded.result, count=excluded.count;
insert into ft_m_report (seq_no,name,last_upd_tms,to_mail,info_mail,mail_sub,blank_mail_body,green_col,amber_col,red_col,query,upd_query,alert_type,alert_lang,rev,action_to_take,result,count) select 7 as seq_no, 'EndBuildIDYardiN' as name, SYSDATE() as last_upd_tms, 'carmen.workman@nuveen.com' as to_mail, 'carmen.workman@nuveen.com' as info_mail, 'NRE:Building Master - Removed Buildings in GS' as mail_sub, 'No Data Found for this Run' as blank_mail_body, 'MAIN_STATUS:OK' as green_col, 'MAIN_STATUS:WARNING' as amber_col, 'MAIN_STATUS:KO' as red_col, 'select ppid.prop_id as buildingid, ppry.property_nme as buildingname, ppid.last_chg_usr_id as update_userid, ppid.last_chg_tms as update_time from ft_T_ppry ppry, ft_T_ppid ppid where 1=1 and ppry.ppry_oid = ppid.ppry_oid  and ppid.prop_id_ctxt_typ = ''ASSETNO'' and ppry.end_tms is not null and ppry.real_estate_owned_ind = ''N'' and ppry.ppty_oid in (select ppty.ppty_oid from ft_T_ppty ppty where ppty.prop_typ = ''Building'') and ppid.end_tms > now()  - INTERVAL ''1'' DAY' as query, NULL as upd_query, 'Report' as alert_type, 'Sql' as alert_lang, 'N' as rev, NULL as action_to_take, NULL as result, '0' as count on conflict(seq_no) where (seq_no=7 and name='EndBuildIDYardiN') do update set seq_no=excluded.seq_no, name=excluded.name, last_upd_tms=excluded.last_upd_tms, to_mail=excluded.to_mail, info_mail=excluded.info_mail, mail_sub=excluded.mail_sub, blank_mail_body=excluded.blank_mail_body, green_col=excluded.green_col, amber_col=excluded.amber_col, red_col=excluded.red_col, query=excluded.query, upd_query=excluded.upd_query, alert_type=excluded.alert_type, alert_lang=excluded.alert_lang, rev=excluded.rev, action_to_take=excluded.action_to_take, result=excluded.result, count=excluded.count;
insert into ft_m_report (seq_no,name,last_upd_tms,to_mail,info_mail,mail_sub,blank_mail_body,green_col,amber_col,red_col,query,upd_query,alert_type,alert_lang,rev,action_to_take,result,count) select 8 as seq_no, 'AssetIDESGComp' as name, SYSDATE() as last_upd_tms, 'lauren.stokes@nuveen.com' as to_mail, 'lauren.stokes@nuveen.com' as info_mail, 'NRE:Building Master - AssetID ESG Comparison Report' as mail_sub, 'No Data Found for this Run' as blank_mail_body, 'MAIN_STATUS:OK' as green_col, 'MAIN_STATUS:WARNING' as amber_col, 'MAIN_STATUS:KO' as red_col, 'select abc.asset_id, abc.esg_asset_id, abc.CHG_USER_ID, abc.CHG_TMS from (select max(case when pprl.ppry_rl_typ = ''Asset'' then prop_id end) as ASSET_ID, max(case when pprl.ppry_rl_typ = ''Property'' then prop_id end) as ESG_ASSET_ID, max(ppid.last_chg_usr_id) as CHG_USER_ID, max(ppid.last_chg_tms) as CHG_TMS from ft_t_pprl pprl, ft_t_ppid ppid where pprl.ppry_oid in (select ppry_oid from ft_t_ppry where ppty_oid = ''NREPPTY004'') and ppid.ppry_oid = pprl.prnt_ppry_oid and ppid.end_tms is null and pprl.end_tms is null and pprl.ppry_rl_typ in (''Asset'',''Property'') and ppid.prop_id_ctxt_typ in (''ESG_ASSET_ID'',''ASST_ID'') group by pprl.ppry_oid) abc where abc.asset_id != abc.esg_asset_id' as query, NULL as upd_query, 'Report' as alert_type, 'Sql' as alert_lang, 'N' as rev, NULL as action_to_take, NULL as result, '0' as count on conflict(seq_no) where (seq_no=8 and name='AssetIDESGComp') do update set seq_no=excluded.seq_no, name=excluded.name, last_upd_tms=excluded.last_upd_tms, to_mail=excluded.to_mail, info_mail=excluded.info_mail, mail_sub=excluded.mail_sub, blank_mail_body=excluded.blank_mail_body, green_col=excluded.green_col, amber_col=excluded.amber_col, red_col=excluded.red_col, query=excluded.query, upd_query=excluded.upd_query, alert_type=excluded.alert_type, alert_lang=excluded.alert_lang, rev=excluded.rev, action_to_take=excluded.action_to_take, result=excluded.result, count=excluded.count;
insert into ft_m_report (seq_no,name,last_upd_tms,to_mail,info_mail,mail_sub,blank_mail_body,green_col,amber_col,red_col,query,upd_query,alert_type,alert_lang,rev,action_to_take,result,count) select 9 as seq_no, 'NREAddressVerfYardiY' as name, SYSDATE() as last_upd_tms, 'lauren.stokes@nuveen.com' as to_mail, 'lauren.stokes@nuveen.com' as info_mail, 'NRE:Building Master - NRE Address Verification' as mail_sub, 'No Data Found for this Run' as blank_mail_body, 'MAIN_STATUS:OK' as green_col, 'MAIN_STATUS:WARNING' as amber_col, 'MAIN_STATUS:KO' as red_col, 'select ntel.main_entity_id,parm_val_txt,ntel.notfcn_crte_tms from ft_T_ntel ntel, ft_T_ppry ppry where ntel.xref_tbl_oid = ppry.ppry_oid and ntel.notfcn_id = 60001 and ntel.notfcn_stat_typ = ''OPEN'' and ppry.real_estate_owned_ind = ''Y''' as query, NULL as upd_query, 'Report' as alert_type, 'Sql' as alert_lang, 'N' as rev, NULL as action_to_take, NULL as result, '0' as count on conflict(seq_no) where (seq_no=9 and name='NREAddressVerfYardiY') do update set seq_no=excluded.seq_no, name=excluded.name, last_upd_tms=excluded.last_upd_tms, to_mail=excluded.to_mail, info_mail=excluded.info_mail, mail_sub=excluded.mail_sub, blank_mail_body=excluded.blank_mail_body, green_col=excluded.green_col, amber_col=excluded.amber_col, red_col=excluded.red_col, query=excluded.query, upd_query=excluded.upd_query, alert_type=excluded.alert_type, alert_lang=excluded.alert_lang, rev=excluded.rev, action_to_take=excluded.action_to_take, result=excluded.result, count=excluded.count;
insert into ft_m_report (seq_no,name,last_upd_tms,to_mail,info_mail,mail_sub,blank_mail_body,green_col,amber_col,red_col,query,upd_query,alert_type,alert_lang,rev,action_to_take,result,count) select 10 as seq_no, 'NREAddressVerfYardiN' as name, SYSDATE() as last_upd_tms, 'carmen.workman@nuveen.com' as to_mail, 'carmen.workman@nuveen.com' as info_mail, 'NRE:Building Master - NRE Address Verification' as mail_sub, 'No Data Found for this Run' as blank_mail_body, 'MAIN_STATUS:OK' as green_col, 'MAIN_STATUS:WARNING' as amber_col, 'MAIN_STATUS:KO' as red_col, 'select ntel.main_entity_id,parm_val_txt,ntel.notfcn_crte_tms from ft_T_ntel ntel, ft_T_ppry ppry where ntel.xref_tbl_oid = ppry.ppry_oid and ntel.notfcn_id = 60001 and ntel.notfcn_stat_typ = ''OPEN'' and ppry.real_estate_owned_ind = ''N''' as query, NULL as upd_query, 'Report' as alert_type, 'Sql' as alert_lang, 'N' as rev, NULL as action_to_take, NULL as result, '0' as count on conflict(seq_no) where (seq_no=10 and name='NREAddressVerfYardiN') do update set seq_no=excluded.seq_no, name=excluded.name, last_upd_tms=excluded.last_upd_tms, to_mail=excluded.to_mail, info_mail=excluded.info_mail, mail_sub=excluded.mail_sub, blank_mail_body=excluded.blank_mail_body, green_col=excluded.green_col, amber_col=excluded.amber_col, red_col=excluded.red_col, query=excluded.query, upd_query=excluded.upd_query, alert_type=excluded.alert_type, alert_lang=excluded.alert_lang, rev=excluded.rev, action_to_take=excluded.action_to_take, result=excluded.result, count=excluded.count;