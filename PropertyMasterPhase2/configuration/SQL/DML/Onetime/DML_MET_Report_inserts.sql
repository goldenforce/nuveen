INSERT INTO ft_m_report (seq_no,"name",last_upd_tms,to_mail,info_mail,mail_sub,blank_mail_body,green_col,amber_col,red_col,query,upd_query,alert_type,alert_lang,rev,action_to_take,"result",count)
select 12,'MET_Invsetment_Grade_report','2024-11-07 05:37:03.010604','DL_Nuveen_FO_IT_Municipals@tiaa.org;DL_Nuveen_DE_SecMaster@in.tiaa.org','DL_Nuveen_FO_IT_Municipals@tiaa.org;DL_Nuveen_DE_SecMaster@in.tiaa.org','MET Investment Grade Report','No Security Rating Downgraded from yesterday to today on SIT','ALERT_STATUS:SUCCESS','ALERT_STATUS:FAILED AND ALERTED','ALERT_STATUS:FAILED','select cusip as "CUSIP",nuveen_global_sec_id as "Nuveen Global Security ID" ,iss_typ as "Security Type", issue_name as "Issue Name",date_trunc(''day'',maturity_date) as "Maturity Date",rating_agency_name as "Rating Agency Name",rating_type as "Rating Type",rating_mnemonic as "Rating Type Code",current_rating_code as "Current Rating Value",previous_rating_code as "Previous Rating Value",current_rank as "Current Rank",previous_rank as "Previous Rank",date_trunc(''day'',current_rtng_effective_date) as "Current Rating Effective Date",date_trunc(''day'',previous_rtng_effective_date) as "Previous Rating Effective Date",current_investment_grade as "Current Investment Grade",previous_investment_grade as "Previous Investment Grade",current_risk_assesment_type as "Current Risk Assessment Type",previous_risk_assesment_type as "Previous Risk Assessment Type",ratingstatus as "Rating Status",report_date as "Report Generation Date" from MET_Investment_Grade_report where ratingstatus=''DOWNGRADED''',NULL,'REPORT','Sql','N',NULL,NULL,'0'
from dual where not exists (select 1 from ft_m_report where seq_no='12');
commit;